<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GamesWTeam - Atualizações</title>
<style>
    body {
        background: #0f0f17;
        color: #d4d4d4;
        font-family: "Segoe UI", sans-serif;
        padding: 20px;
    }

    h1 {
        text-align: center;
        color: #76ff7a;
        margin-bottom: 25px;
    }

    .panel {
        background: #14141f;
        border: 1px solid #2a2a38;
        padding: 20px;
        border-radius: 12px;
        max-width: 900px;
        margin: auto;
        box-shadow: 0 0 12px #00000055;
    }

    .green { color: #76ff7a; }
    .yellow { color: #ffe56d; }
    .orange { color: #ffb86c; }
    .red { color: #ff6b6b; }
    .purple { color: #c679ff; }

    .quality-box {
        padding: 15px;
        border-radius: 8px;
        margin-top: 20px;
        font-weight: bold;
        text-align: center;
        font-size: 1.2rem;
        border: 1px solid #2d2d3a;
    }

    .file-list {
        background: #191926;
        border: 1px solid #2e2e40;
        padding: 15px;
        border-radius: 8px;
        margin-top: 20px;
        max-height: 300px;
        overflow-y: auto;
        font-size: 0.95rem;
    }

    .file-item {
        padding: 6px 0;
        margin-bottom: 4px;
        border-bottom: 1px solid #2e2e40;
    }
</style>
</head>
<body>
<header>
    <img src="https://i.imgur.com/FZAhV5D.png" alt="GamesWTeam Logo">
    <h1>GamesWTeam - Lista de Atualizações</h1>
</header>
<div class="container">
    <div class="info-box">
        <div><span class="label">Total de Arquivos:</span> <span id="totalArquivos">...</span></div>
        <div><span class="label">Tamanho Total:</span> <span id="tamanhoTotal">...</span></div>

    <div class="info-box">
        <div><span class="label">Qualidade do Update:</span> <span id="qualidadeUpdate">...</span></div>
        <div id="mensagemQualidade" style="margin-top:5px; color:#aaa;"></div>
    </div>
</div>

    <table>
        <thead>
            <tr>
                <th>Arquivo</th>
                <th>Hash</th>
                <th>Tamanho</th>
            </tr>
        </thead>
        <tbody id="lista"></tbody>
    </table>
</div>

<script>
async function loadPatchList() {
    const fileUrl = "ListaPatch.txt";

    try {
        const response = await fetch(fileUrl);

        if (!response.ok) {
            updateUI([], 0);
            return;
        }

        const text = await response.text();
        const lines = text.trim().length ? text.trim().split(/
?
/) : [];
        updateUI(lines);
    } catch (e) {
        updateUI([], 0);
    }
}

function updateUI(lines) {
    const listDiv = document.getElementById("fileList");
    const totalCountDiv = document.getElementById("totalCount");
    const totalSizeDiv = document.getElementById("totalSize");
    const qualityDiv = document.getElementById("qualityBox");

    listDiv.innerHTML = "";

    if (!lines || lines.length === 0) {
        totalCountDiv.textContent = "0 arquivos";
        totalSizeDiv.textContent = "0 bytes";
        qualityDiv.textContent = "Nenhum update detectado";
        qualityDiv.className = "quality-box purple";
        return;
    }

    let totalSize = 0;

    lines.forEach(line => {
        const [name, hash, size] = line.split(" ");
        const sizeNum = parseInt(size) || 0;
        totalSize += sizeNum;

        const item = document.createElement("div");
        item.className = "file-item";
        item.innerHTML = `<span class='green'>${name}</span> — ${sizeNum.toLocaleString()} bytes`;
        listDiv.appendChild(item);
    });

    totalCountDiv.textContent = `${lines.length} arquivos`;
    totalSizeDiv.textContent = `${totalSize.toLocaleString()} bytes`;

    // qualidade
    let quality = "";
    let color = "";

    if (lines.length <= 100) { quality = "Excelente"; color = "green"; }
    else if (lines.length <= 300) { quality = "Regular"; color = "yellow"; }
    else if (lines.length <= 500) { quality = "Atenção"; color = "orange"; }
    else if (lines.length <= 800) { quality = "Ruim"; color = "red"; }
    else { quality = "Péssimo — Recomenda-se urgentemente baixar um novo cliente"; color = "purple"; }

    qualityDiv.textContent = `Qualidade do Update: ${quality}`;
    qualityDiv.className = `quality-box ${color}`;
}

loadPatchList();
// FIX: remover 'avaliarQualidade(totalArquivos);' solto

function avaliarQualidade(qtd) {
    let status = '';
    let msg = '';
    let cor = '';

    if (qtd <= 100) { status = 'Excelente'; msg = 'Atualização leve e saudável!'; cor = '#00ff66'; }
    else if (qtd <= 300) { status = 'Regular'; msg = 'Atualização mediana.'; cor = '#aaff00'; }
    else if (qtd <= 500) { status = 'Atenção'; msg = 'Muitos arquivos!'; cor = '#ffaa00'; }
    else if (qtd <= 800) { status = 'Ruim'; msg = 'Atualização muito pesada.'; cor = '#ff5500'; }
    else { status = 'Péssimo'; msg = 'Recomenda-se cliente novo!'; cor = '#ff0033'; }

    const q = document.getElementById('qualidadeUpdate');
    q.textContent = status;
    q.style.color = cor;

    const m = document.getElementById('mensagemQualidade');
    m.textContent = msg;
    m.style.color = cor;
}

carregarLista();
</script>
</body>
</html>
